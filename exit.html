<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™êµ ë³µë„: ë¹›ì˜ ì¸ë„ ìµœì¢…ë³¸</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #000; font-family: 'serif'; }
        .game-container { position: relative; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        .background-img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.3) contrast(1.2) hue-rotate(180deg); transition: all 1s ease; cursor: crosshair; }
        
        .hotspot { position: absolute; cursor: pointer; z-index: 10; }

        /* [ì¤‘ìš”] ìœ„ì¹˜ê°€ ì•ˆ ë§ìœ¼ë©´ ì•„ë˜ ì£¼ì„ì„ í•´ì œí•´ì„œ ë¶‰ì€ ì‚¬ê°í˜•ì„ í™•ì¸í•˜ì„¸ìš” */
        /* .hotspot { border: 2px solid red; background: rgba(255, 0, 0, 0.1); } */

        #inventory { position: absolute; top: 20px; right: 20px; width: 100px; height: 100px; border: 2px dashed #303060; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #6060ff; font-size: 0.7rem; background: rgba(0,0,0,0.6); border-radius: 10px; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 15, 0.95); display: flex; justify-content: center; align-items: center; z-index: 100; }
        .hidden { display: none !important; }
        .box { background: #050515; color: #b0b0e0; padding: 40px; border: 1px solid #303060; box-shadow: 0 0 30px rgba(0, 0, 255, 0.5); text-align: center; max-width: 450px; border-radius: 10px; }
        button { background: transparent; color: #6060ff; border: 1px solid #6060ff; padding: 10px 25px; cursor: pointer; margin-top: 20px; }
        button:hover { background: #6060ff; color: #fff; }
        input { background: #101025; border: 1px solid #6060ff; color: #fff; padding: 12px; width: 80%; font-size: 1.5rem; text-align: center; margin-bottom: 20px; letter-spacing: 5px; }
        #escape-btn { position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%); z-index: 50; padding: 15px 40px; background: rgba(0, 0, 30, 0.8); color: #fff; border: 2px solid #6060ff; cursor: pointer; }
    </style>
</head>
<body onclick="handleBackgroundClick(event)">

    <div class="game-container">
        <img src="background.png" id="main-bg" class="background-img">
        <div id="inventory"><span>Inventory</span><div id="flashlight-item" style="display:none; color: yellow; font-size: 1.2rem; margin-top: 5px;">ğŸ”¦</div></div>

        <div id="hotspot-trash" class="hotspot" style="top: 50%; left: 51%; width: 14%; height: 35%;" onclick="handleTrash(event)"></div>
        <div id="hotspot-frame" class="hotspot" style="top: 15%; left: 75%; width: 15%; height: 25%;" onclick="handleFrame(event)"></div>
        <div id="hotspot-light" class="hotspot" style="top: 15%; left: 35%; width: 30%; height: 20%;" onclick="handleLight(event)"></div>
        
        <div id="hotspot-hidden" class="hotspot" style="top: 65%; left: 2%; width: 20%; height: 30%;" onclick="handleHidden(event)"></div>

        <button id="escape-btn" onclick="openAnswerModal(event)">ì ê¸´ ë¬¸ ì—´ê¸°</button>
    </div>

    <div id="start-modal" class="overlay"><div class="box"><h1>ì¹¨ë¬µì˜ ë³µë„</h1><p>"ì–´ë‘  ì†ì— ê°‡í˜”ë‹¤. íƒˆì¶œí•  ë°©ë²•ì„ ì°¾ì•„ë³´ì."</p><button onclick="startGame()">íƒìƒ‰ ì‹œì‘</button></div></div>
    <div id="info-modal" class="overlay hidden"><div class="box"><p id="info-text" style="font-size: 1.2rem; line-height: 1.6; white-space: pre-wrap;"></p><button onclick="closeModal()">í™•ì¸</button></div></div>
    <div id="answer-modal" class="overlay hidden"><div class="box"><h3>ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</h3><input type="text" id="answer-input" maxlength="4" placeholder="0000"><br><button onclick="checkAnswer()">í™•ì¸</button><button onclick="closeModal()">ì·¨ì†Œ</button></div></div>

    <audio id="audio-bgm" src="bgm.mp3" loop></audio>
    <audio id="audio-trash" src="trash.mp3"></audio>
    <audio id="audio-frame" src="frame.mp3"></audio>
    <audio id="audio-miss" src="miss.mp3"></audio>
    <audio id="audio-item" src="item.mp3"></audio>

    <script>
        const infoModal = document.getElementById('info-modal');
        const answerModal = document.getElementById('answer-modal');
        const bgm = document.getElementById('audio-bgm');
        
        let isTrashChecked = false;
        let isFrameAttempted = false;
        let hasFlashlight = false;
        let missClickCount = 0;

        function startGame() { document.getElementById('start-modal').classList.add('hidden'); bgm.volume = 0.3; bgm.play(); }

        function handleBackgroundClick(e) {
            if (!e.target.classList.contains('hotspot') && e.target.id !== 'escape-btn') {
                document.getElementById('audio-miss').currentTime = 0;
                document.getElementById('audio-miss').play();
                
                missClickCount++;
                
                if (!isTrashChecked && missClickCount >= 5) {
                    showInfo("í—ˆê³µì„ ë’¤ì ¸ë´ì•¼ ì†Œìš©ì—†ë‹¤. ì €ê¸° ê°€ë“ ì°¬ íœ´ì§€í†µì€ ì–´ë–¨ê¹Œ?");
                    missClickCount = 0;
                }
                else if (isFrameAttempted && !hasFlashlight && missClickCount >= 5) {
                    showInfo("ì–´ë‘  ì†ì„ ë¹„ì¶œ ë„êµ¬ê°€ í•„ìš”í•´. ì™¼ìª½ ì‚¬ë¬¼í•¨ ìª½ ë°”ë‹¥ì„ ë” ìì„¸íˆ ì‚´í´ë³´ì.");
                    missClickCount = 0;
                }
            }
        }

        function handleLight(e) {
            e.stopPropagation();
            showInfo("ë³µë„ ë¶ˆì€ ì¼œì§€ì§€ ì•ŠëŠ”ë‹¤. ê±´ì „ì§€ê°€ ë‹¤ ëœ ê±¸ê¹Œ? ë‹¤ë¥¸ ë„êµ¬ê°€ í•„ìš”í•˜ë‹¤.");
        }

        function handleTrash(e) {
            e.stopPropagation();
            document.getElementById('audio-trash').play();
            isTrashChecked = true;
            missClickCount = 0;
            showInfo("íœ´ì§€í†µ ì† ìª½ì§€:\n'ì§„ì‹¤ì€ ì•¡ì ì†ì— ê¸°ë¡ë˜ì–´ ìˆë‹¤. í•˜ì§€ë§Œ ì–´ë‘ ì´ ê·¸ê²ƒì„ ê°€ë¦¬ê³  ìˆì„ ê²ƒì´ë‹¤.'");
        }

        function handleFrame(e) {
            e.stopPropagation();
            if (!isTrashChecked) {
                showInfo("í‰ë²”í•œ ì•¡ìë‹¤. ì§€ê¸ˆì€ ë‹¤ë¥¸ ê³³ì„ ë¨¼ì € ì¡°ì‚¬í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.");
            } else if (!hasFlashlight) {
                isFrameAttempted = true;
                missClickCount = 0;
                showInfo("ì•¡ì ì•„ë˜ì— ë¬´ì–¸ê°€ ì í˜€ ìˆì§€ë§Œ, ë„ˆë¬´ ì–´ë‘ì›Œì„œ ì½ì„ ìˆ˜ê°€ ì—†ë‹¤. ë¹›ì´ í•„ìš”í•˜ë‹¤.");
            } else {
                document.getElementById('audio-frame').play();
                showInfo("ì†ì „ë“±ìœ¼ë¡œ ì•¡ìë¥¼ ë¹„ì¶”ì ìˆ¨ê²¨ì§„ ê¸€ìê°€ ì„ ëª…í•˜ê²Œ ë³´ì¸ë‹¤.\n\n'ê°œêµ ê¸°ë…ì¼: 08ì›” 15ì¼'");
            }
        }

        function handleHidden(e) {
            e.stopPropagation();
            if (!isFrameAttempted) {
                showInfo("ë„ˆë¬´ ì–´ë‘ì›Œì„œ ì•„ë¬´ê²ƒë„ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.");
                return;
            }
            if (!hasFlashlight) {
                hasFlashlight = true;
                document.getElementById('audio-item').play();
                document.getElementById('flashlight-item').style.display = 'block';
                showInfo("ì‚¬ë¬¼í•¨ êµ¬ì„ì—ì„œ 'ì†ì „ë“±'ì„ ë°œê²¬í–ˆë‹¤!\nì´ì œ ì•¡ìì— ì íŒ ê¸€ìë¥¼ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.");
                document.getElementById('main-bg').style.filter = "brightness(0.5) contrast(1.1) hue-rotate(180deg)";
            }
        }

        function openAnswerModal(e) { e.stopPropagation(); answerModal.classList.remove('hidden'); }
        function showInfo(text) { document.getElementById('info-text').innerText = text; infoModal.classList.remove('hidden'); }
        function closeModal() { infoModal.classList.add('hidden'); answerModal.classList.add('hidden'); }

        // [ìˆ˜ì •ëœ ë¶€ë¶„] ì •ë‹µ í™•ì¸ ë° í˜ì´ì§€ ì´ë™ ë¡œì§
        function checkAnswer() {
            const userInput = document.getElementById('answer-input').value;
            if (userInput === "0815") {
                // ì‹œê°ì  í”¼ë“œë°±: ë°°ê²½ ë°ê²Œ ì „í™˜
                document.getElementById('main-bg').style.filter = "brightness(1.1) contrast(1) hue-rotate(0deg)";
                
                // ì„±ê³µ ì•Œë¦¼ í›„ ì´ë™
                alert("ì² ì»¥! ë¬¸ì´ ì—´ë ¸ìŠµë‹ˆë‹¤. íƒˆì¶œ ì„±ê³µ!\nê°•ë‹¹ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
                window.location.href = "https://assisi-francesco.github.io/escapeRoom/"; 
            } else { 
                alert("ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤. ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”."); 
            }
        }
    </script>
</body>
</html>
